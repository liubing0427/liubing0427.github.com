
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="baidu_union_verify" content="dafe71a3b0ba246dbd433cb490d3310d"/>
    <meta name="google-site-verification" content="mw1KOVgTAORcoHehGDB5jnRa3xBuNuwCTXVqSvxyqBI"/>
    <meta name="msvalidate.01" content="4DC3638736C584D35FE2CB969B115974"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <link rel="shortcut icon" href="/images/favicon.ico"/>
    <title>C#获取电脑的公网IP</title>
</head>
<body>

<meta name="description" content="使用C# WebClient联网获取内网电脑的公网IP"/>

<meta name="author" content="Liu Bing"/>
<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<!-- Le styles -->
<link href="//cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet"/>
<link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all"/>
<link href="http://7d9pos.com1.z0.glb.clouddn.com/css/pygments.css?body=1" rel="stylesheet" type="text/css" media="all"/>
<link href="http://7d9pos.com1.z0.glb.clouddn.com/Font-Awesome/css/font-awesome.min.css" rel="stylesheet"/>
<!-- Le fav and touch icons -->
<!-- Update these with your own images
  <link rel="shortcut icon" href="images/favicon.ico">
  <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
-->

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">
                <b class="brand__forename">Bing's</b>
                <b class="brand__surname">Blog</b>
            </a>
        </div>
        <div class="navbar-collapse collapse" id="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <ul class="nav navbar-nav">
                <li><a href="/archive"><i class="icon-large icon-th-list"></i><b class="title_name"> Archive</b></a>
                </li>
                <!--<li><a href="/categories"><i class="icon-large icon-folder-open"></i><b class="title_name">
                    Categories</b></a></li>
                <li><a href="/tags"><i class="icon-large icon-tags"></i><b class="title_name"> Tags</b></a></li>-->
                <li><a href="/app"><i class="icon-large icon-th-large"></i><b class="title_name"> App</b></a></li>
                <li><a href="/about"><i class="icon-large icon-user"></i><b class="title_name"> About Me</b></a>
                </li>
                <li><a href="/messageboard"><i class="icon-large icon-comment"></i><b class="title_name"> Message Board</b></a></li>
                <li><a class="rss_feed" href="/atom.xml"><i class="icon-large icon-rss"></i><b class="title_name"> Rss</b></a></li>
            </ul>
        </div>
    </div>
</nav>
<div class="container">
    <div class="row">
        
<div class="page-header">
    <h1>
        [<a href="/categories#程序-ref">程序</a>] C#获取电脑的公网IP
        <small>-- 28 August 2013 </small>
    </h1>
</div>

<div class="col-md-8 main-content">
    <div class="post page">
        
<p>使用WebClient访问可以获取IP的网站,通过正则表达式抓取页面中的IP.<p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#"><span></span><span class="n">WebClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WebClient</span><span class="p">();</span>
<span class="kt">byte</span><span class="p">[]</span> <span class="n">bytRecv</span> <span class="p">=</span> <span class="n">client</span><span class="p">.</span><span class="n">DownloadData</span><span class="p">(</span> <span class="s">&quot;http://get-ip.me/&quot;</span><span class="p">);</span><span class="c1">//下载网页数据</span>
<span class="kt">string</span> <span class="n">str</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">bytRecv</span><span class="p">);</span>
<span class="kt">string</span> <span class="n">r</span> <span class="p">=</span> <span class="s">@&quot;((?:(?:25[0-5]|2[0-4]\d|[01]?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d?\d))&quot;</span><span class="p">;</span>
<span class="kt">string</span> <span class="n">ip</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">RegularExpressions</span><span class="p">.</span><span class="n">Regex</span><span class="p">.</span><span class="n">Match</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">r</span><span class="p">).</span><span class="n">ToString</span><span class="p">();</span><span class="c1">//提取信息 </span></code></pre></figure>

</p></p>

    </div>
    <div class="text-center">
        <div class="pagination">
            <ul>
                
                <li class="prev disabled"><a><i class="icon-fixed-width icon-arrow-left"></i> Previous</a></li>
                
                <li><a href="/archive">Archive</a></li>
                
                <li class="next"><a href="/Blog/2013/11/27/sql" title="一些有用的Sql语句"><i class="icon-fixed-width icon-arrow-right"></i> Next</a></li>
                
            </ul>
        </div>
    </div>
    <div class="comments">
        


  <div id="gitmentComments"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
  owner: 'liubing0427',
  repo: 'liubing0427.github.com',
  oauth: {
    client_id: 'd02658d99eca68237708',
    client_secret: '39fb7e21279923bb48a0dd91315330e8f7b12796',
  },
})
gitment.render('gitmentComments')
</script>





    </div>
</div>
<div class="col-md-4 sidebar">
    <div class="widget">
        
        <div class="sidebar-title"><i class="icon-fixed-width icon-tags"></i> Tags</div>
        <ul class="tag_box inline">
            
            


  
     
    	<li><a href="/tags#c#-ref">c# <span>1</span></a></li>
     
    	<li><a href="/tags#IP-ref">IP <span>1</span></a></li>
    
  



        </ul>
        
    </div>

    <div class="widget">
        <div class="sidebar-title"><i class="icon-fixed-width icon-file-text"></i> Related</div>
        <ul>
            
        </ul>
    </div>
    <!-- Baidu Button BEGIN -->
    


  <script type="text/javascript" id="bdshare_js" data="type=slide&amp;img=2&amp;pos=right&amp;uid=254497" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000);
</script>





    <!-- Baidu Button END -->
</div>


    </div>
</div>
<!-- /container -->
<footer class="footer ">
    <div class="container">
        <hr>
        <div class="row footer-bottom">
            <ul class="list-inline text-center">
                <li><p>&copy; Liu Bing 2018 </p></li>
            </ul>
        </div>
    </div>
</footer>
<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
<script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>



  <script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fb8e145711258e179270df3c5f1b3c84b' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>






</body>
</html>

